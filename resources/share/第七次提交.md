在xml文件中定义bean xml-file-define-bean

以往都是手动编写BeanDefinition，手动写PropertyValues，那也让使用我们代码的用户也这样写吗？显然不太好。在这一章节中，我们新增了BeanDefinitionReader接口、AbstractBeanDefinitionReader抽象类、XmlBeanDefinitionReader类，支持用户提供给xml配置文件，程序提供xml解析功能

1.BeanDefinitionReader接口中提供了loadBeanDefinitions()接口，可以传入Resource，也可以传入location，还可以传入locations集合。最终目标是获取到数据内容的字节输入流InputStream。

2.注意，BeanDefinitionReader接口中还提供了getRegistry()方法，这是因为我们后面要将BeanDefinition注册到definitionMap中，在AbstractBeanDefinitionReader中将registry作为一个属性，用的时候作为构造函数一个参数创建即可。

3.解析XML配置文件的方法为：doLoadBeanDefinition()；功能逻辑如下：

    a.使用XmlUtil对inputStream字节流解析，获取到Document对象，然后再获取到其子节点集合 -> bean标签集合（集合中可能存在换行符，所以需要判断类型）
    
    b.遍历bean标签的时候，要获取id 、 name 、 class属性内容，创建BeanDefinition对象，传入Class属性。
    
    c.遍历property标签的时候，要获取到对应的name 、 value 、ref属性内容，创建对应的PropertyValue对象，并且给BeanDefinition对象传入PropertyValues属性。
    
    d.最后一个bean处理完之后，将对应的beanName 和  BeanDefinition 对象传入到 map中！需要用到BeanDefinitionRegistry接口中的getRegistry()方法
    
    补充：这里如果遇到ref属性的引用对象，会在创建PropertyValue对象的时候，将BeanRerference对象作为value。

3.小总结：

分为两条线吧，一条线A是进行解析封装BeanDefinition对象 ；一条线B是进行反射机制实例化、属性注入等逻辑 ;

    A. 进行解析封装BeanDefinition对象
    
    以前都是通过DefaultListableBeanFactory类中的registerBeanDefinition()方法手动添加BeanDefinition的，现在通过解析xml配置文件，并且DefaultListableBeanFactory类中提供了beanDefinitionMap属性。
    
        1.在创建XmlBeanDefinitionReader的时候，需要传递一个BeanDefinitionRegistry接口类。正好DefaultListableBeanFactory就可以
        
        2.然后搭配ResourceLoader类获取XML配置文件对应的Resource类，然后再loadBeanDefinitions即可！


    B.反射机制实例化、属性注入逻辑。
    
        1.  一般入口就是getBean(beanName)，这个方法是在AbstractBeanFactory抽象类中实现的，首先会直接从父类DefaultSingletonBeanRegistry的单例表属性中进行获取，如果没有的话， 就会执行createBean()方法，这个方法是抽象的，具体是交给AbstractAutowireCapableBeanFactory类去实现的。但是实现的时候还需要Bean对应的BeanDefinition类，所以又需要一个getBeanDefinition()方法，因此这个方法也是抽象的，具体的实现是交给DefaultListableBeanFactory来实现的。
        
        2.  然后就到了AbstractAutowireCapableBeanFactory中实现的createBean()方法了，借助了doCreateBean()方法，通过BeanDefinition对象中的Class 和 PropertyValues属性 搭配反射机制进行实例化和属性注入！
        
        3.  补充：属性注入的时候，如果遇到PropertyValue中的属性value类型为BeanReference类型的话，就会先进行这个bean的实例化，也是会调用getBean(beanName)！
        
        4.  最后一个bean创建完成之后，就调用父接口SingletonBeanRegistry的addSingleton()方法，保存到map中！

