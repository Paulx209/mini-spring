【type-conversion-second-part 类型转换二】

将类型转换的功能融入到IOC容器中。

## 需要执行类型转换的地方在哪里？

1.属性注入的时候，之前是通过BeanUtil的setFieldValue方法来实现反射赋值的，虽然说我们的value都是String类型的，但是里面也涉及到了convert类型转换的逻辑

2.还有一个点就是，属性注入之前处理@Value注解的时候，也是用到了setFieldValue方法

补充：占位符替换的时候，只是对PropertyValue做了更新，并没有涉及对属性注入的情况。

## 这章主要是逻辑是什么？
1.我们要实现类型的转换的话，就要引用ConversionService接口，并且在其它类实例化之前这个类就要初始化完成！

所以我们修改AbstractApplicationContext类中doRefresh()方法中**提前实例化**的逻辑，在实例化其他bean之前，获取到我们对应的ConversionService的beanDefinition，然后进行实例化、初始化

2.那我们可以使用factoryBean的getObject()方法来创建ConversionService，会借助afterPropertiesSet()方法来初始化ConversionService，给他注册一些converter。


3.主要执行的时机在于：每个类在实例化之后，属性注入之前扫描@Value注解的时候，执行一次；以及在属性注入的时候执行一次。
    
逻辑为：获取到sourceType、targetType，然后调用conversionService.convert()方法进行转换。

